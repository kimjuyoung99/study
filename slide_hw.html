<!DOCTYPE html>
<html lang="eng">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title></title>
  <link rel="stylesheet" href="slide_hw.css" />
</head>
<body>
  <main>
    <h1>슬라이드 연습</h1>
    <section class="slide">
      <h2>슬라이드 섹션영역</h2>
      <div class="slide-wrap">
        <ul class="sliderUl">
          <li class="sldier">
            <div>
              <p>슬라이드 번호1</p>
              <img src="https://picsum.photos/400/600" alt="" />
            </div>
          </li>
          <li class="sldier">
            <div>
              <p>슬라이드 번호2</p>
              <img src="https://picsum.photos/800/500" alt="" />
            </div>
          </li>
          <li class="sldier">
            <div>
              <p>슬라이드 번호3</p>
              <img src="https://picsum.photos/300/600" alt="" />
            </div>
          </li>
        </ul>
      </div>
      <button class="btn prev">이전</button>
      <button class="btn next">다음</button>
      <div class="slider-dot">
        <span class="dot1">1</span>
        <span class="dot2">2</span>
        <span class="dot3">3</span>
      </div>
    </section>
  </main>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const sliderUl = document.querySelector('.sliderUl');
      const slides = document.querySelectorAll('.sldier');
      const prevBtn = document.querySelector('.prev');
      const nextBtn = document.querySelector('.next');
      const dots = document.querySelectorAll('.slider-dot span');

      let currentIndex = 0;
      const slideCount = slides.length;

      function initSlider() {
        const firstSlideClone = slides[0].cloneNode(true);
        const lastSlideClone = slides[slideCount - 1].cloneNode(true);
        sliderUl.appendChild(firstSlideClone);
        sliderUl.insertBefore(lastSlideClone, slides[0]);

        sliderUl.style.width = `${(slideCount + 2) * 100}%`;
        const allSlides = sliderUl.querySelectorAll('.sldier');
        allSlides.forEach(slide => {
          slide.style.width = `${100 / (slideCount + 2)}%`;
        });
        
        sliderUl.style.transform = `translateX(-${100 / (slideCount + 2)}%)`;
        currentIndex = 0; // 초기 위치를 슬라이드1 로 설정
        updateDots();
      }

      function updateSlider(index) {
        sliderUl.style.transition = 'transform 0.3s ease-out';
        sliderUl.style.transform = `translateX(-${(index + 1) * (100 / (slideCount + 2))}%)`;
        currentIndex = index;
        updateDots();
      }

      function nextSlide() {
        if (currentIndex >= slideCount - 1) {
          updateSlider(slideCount);
          setTimeout(() => {
            sliderUl.style.transition = 'none';
            sliderUl.style.transform = `translateX(-${100 / (slideCount + 2)}%)`;
            currentIndex = 0;
            updateDots();
          }, 300);
        } else {
          updateSlider(currentIndex + 1);
        }
      }

      function prevSlide() {
        if (currentIndex <= 0) {
          updateSlider(-1);
          setTimeout(() => {
            sliderUl.style.transition = 'none';
            sliderUl.style.transform = `translateX(-${slideCount * (100 / (slideCount + 2))}%)`;
            currentIndex = slideCount - 1;
            updateDots();
          }, 300);
        } else {
          updateSlider(currentIndex - 1);
        }
      }

      function updateDots() {
        dots.forEach((dot, index) => {
          dot.style.backgroundColor = index === currentIndex ? 'black' : 'tomato';
          dot.style.color = index === currentIndex ? 'white' : 'black';
        });
      }

      nextBtn.addEventListener('click', nextSlide);
      prevBtn.addEventListener('click', prevSlide);

      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
          updateSlider(index);
        });
      });

      initSlider();
    });
  </script>
</body>
</html>
